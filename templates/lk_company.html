<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>WorkWise - Личный кабинет сотрудника</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Montserrat:wght@200;300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/style.css') }}"
    />
  </head>
  <body>
    <div id="lkPage">
      <nav class="top-nav">
        <div class="nav-left">
          <button class="menu-toggle" id="menuToggle">☰</button>
          <span class="logo">WorkWise</span>
        </div>
        <div class="nav-links"></div>
        <div class="user-info-nav">{{ user.login }}</div>
      </nav>

      <aside class="sidebar" id="sidebar">
        <div class="user-info">
          <div class="avatar">{{ user.login[:2]|upper }}</div>
          <div class="user-name">{{ user.login }}</div>
        </div>

        <div class="sidebar-menu">
          <div class="menu-item active">Мои работы</div>
          <a href="{{ url_for('settings') }}" class="menu-item">Настройки</a>
          <div class="divider"></div>

          <a href="{{ url_for('logout') }}" class="logout-btn" id="logoutBtn"
            >Выйти</a
          >
        </div>
      </aside>

      <main class="main-content" id="mainContent">
        <div class="welcome-section">
          <h1 class="welcome-text">Добро пожаловать, {{ user.login }}!</h1>
        </div>

        <div class="control-panel">
          <div class="panel-title">Проверить новую работу</div>
          <div class="panel-content">
            <div class="tariff-selection">
              <label class="tariff-label">Ваша компания:</label>
              <div class="static-tariff">
                {{ user.company.name if user.company else 'Не привязана' }}
              </div>
            </div>
            <div class="upload-section">
              <button
                class="upload-btn"
                id="uploadBtn"
                onclick="window.location.href='{{ url_for('check_file') }}'"
              >
                Загрузить файл
              </button>
            </div>
          </div>
        </div>

        <div class="works-header">
          <h2>ПРОВЕРЕННЫЕ РАБОТЫ</h2>
        </div>

        <div class="works-container">
          {% if uploads %} {% for upload in uploads %}
          <div class="work-card">
            <div class="work-header">
              <div class="work-title">{{ upload.filename }}</div>
            </div>
            <div class="work-details">
              <div class="work-date">
                Дата проверки: {{ upload.upload_date.strftime('%d.%m.%Y') }}
              </div>
              <div class="work-status" style="margin-top: 5px; color: #5fa99b">
                Статус: {{ upload.status }}
              </div>
            </div>
            <div class="work-actions">
              <a
                href="{{ url_for('process_file', upload_id=upload.id) }}"
                class="details-btn"
                >Подробнее</a
              >
            </div>
          </div>
          {% endfor %} {% else %}
          <p style="color: #b6d4cf; padding: 20px">Работ пока нет.</p>
          {% endif %}
        </div>
      </main>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const menuToggle = document.getElementById("menuToggle");
        const sidebar = document.getElementById("sidebar");
        const mainContent = document.getElementById("mainContent");

        menuToggle.addEventListener("click", function () {
          sidebar.classList.toggle("active");
          mainContent.classList.toggle("shifted");
        });

        document.addEventListener("click", function (event) {
          if (
            !sidebar.contains(event.target) &&
            !menuToggle.contains(event.target) &&
            sidebar.classList.contains("active")
          ) {
            sidebar.classList.remove("active");
            mainContent.classList.remove("shifted");
          }
        });
      });
    </script>
  </body>
</html>
